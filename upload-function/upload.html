<!DOCTYPE html>
<html>

<head>
  <title>Upload Image</title>
  <meta charset="UTF-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<style type="text/css">
  button {
    padding: 8px 16px;
    font-size: 16px;
    color: white;
    background-color: #4CAF50;
    border: none;
    cursor: pointer;
  }

  div {
    width: 50%;
    /* Largeur de la div */
    margin-left: 33%;
    margin-top: 20%;
  }
</style>

<body>
  <div>
    <form>
      <label for="file-input">Choose a file to upload:</label>
      <input type="file" id="file-input">
      <button type="submit">Upload</button>
    </form>
  </div>
  <script type="text/javascript">
    // Get the form element
    const form = document.querySelector('form');

    // Listen for the submit event on the form
    form.addEventListener('submit', (event) => {
      // Prevent the default form submission behavior
      event.preventDefault();

      // Get the file input element
      const fileInput = form.querySelector('input[type="file"]');

      // Get the selected file
      const file = fileInput.files[0];

      // Create a new FileReader instance
      const reader = new FileReader();

      // Listen for the load event on the FileReader

      reader.readAsDataURL(file);


      reader.addEventListener('load', () => {
        // Get the contents of the file as a data URL
        const dataURL = reader.result;

        var formData = new FormData();
        formData.append('image', file);

        var url = 'https://europe-west1-episen-blur-project.cloudfunctions.net/CFunctions-HTTP-input'


        $.ajax({
          url: url,
          type: 'post',
          enctype: 'multipart/form-data',
          crossDomain: true,
          processData: false,
          contentType: false,
          data: formData,
          success: function (data) {
            console.info(data);
          },
          error: function (data) {
            console.log(data)
          }
        });



      });

      // Read the file as a data URL
    });

  </script>
</body>

</html>
